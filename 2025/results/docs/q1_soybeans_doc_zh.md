# 2025 APMCM Problem C 第一问说明文档：大豆贸易模型与数据

## 1. 问题概述

本说明文档针对 2025 APMCM Problem C 第一问，系统整理我们关于“中国自美国、巴西、阿根廷三国大豆进口在关税调整下的变化”的建模思路、数据来源与处理流程，以及模型结构与主要结论。文中描述与代码文件 `src/models/q1_soybeans.py` 和标准化数据文件 `data/processed/q1/q1_0.csv` 一一对应。

第一问的核心任务包括：

- **刻画现状**：分析中国与美国、巴西、阿根廷之间的大豆贸易格局与演变趋势；
- **建立模型**：构建关税—价格—需求—市场份额的传导模型，量化中国对三国大豆进口对关税与价格的敏感度；
- **情景预测**：在美国关税政策调整及中国反制关税变动的背景下，预测三国对华大豆出口量与出口额的新分布，分析对三国大豆产业的影响。

---

## 2. 数据来源与筛选

### 2.1 题目提供的美国贸易与关税数据

题目提供的基础数据主要来自 U.S. Trade & Tariff Data（USITC DataWeb）：

- 美国出口数据：`DataWeb-Query-Export__FAS_Value.csv`
- 美国进口数据：`DataWeb-Query-Import__General_Import_Charges.csv`
- 2015–2025 年美国关税数据库：`tariff_database_YYYY.csv`

这些数据涵盖按 HTS/HS 编码细分的商品贸易数据，覆盖多国双边贸易关系，为整体关税环境与美国对外贸易状况提供背景支撑。

在解决第一问时，上述数据主要用于：

- 识别与大豆相关的 HS/HTS 编码；
- 从整体关税数据库中提取与大豆及相关农产品有关的税率信息，为构造情景时提供合理区间参考。

### 2.2 外部数据：中国大豆进口统计

由于题目附带数据以“美国对外贸易”为主，缺乏“中国从三国进口大豆”的直接统计，为建立中国视角的需求模型，我们根据题目提示和公开数据源（如中国海关总署 GACC 等）整理了中国自三国进口大豆的数据，包括：

- 按年份划分的中国自美国、巴西、阿根廷进口大豆数量（吨）和金额（美元）；
- 中国对三国大豆实施的从价关税税率（含贸易战前后的调整和部分回调）。

这些数据经过整理、对齐和单位统一后，被保存到 `data/processed/q1/q1_0.csv` 中，作为第一问建模的标准化输入文件。

### 2.3 标准化数据文件 `q1_0.csv`

`q1_0.csv` 中包含 2015–2024 年中国自三国进口大豆的年度面板数据，字段如下：

- `year`：年份（2015–2024）；
- `exporter`：出口国，取值为 `US`、`Brazil`、`Argentina`；
- `import_quantity_tonnes`：中国自该国进口大豆数量，单位为吨；
- `import_value_usd`：中国自该国进口大豆金额，单位为美元；
- `unit_price_usd_per_ton`：单位价格（美元/吨）；
- `tariff_cn_on_exporter`：中国对该出口国大豆适用的从价关税税率（小数形式，如 0.03 表示 3%）。

在 `q1_soybeans.py` 中，这一文件通过 `SoybeanTradeModel.load_external_china_imports()` 方法读入，并作为后续变量构造与模型估计的基础。

---

## 3. 数据处理与特征构造

### 3.1 进口规模与结构的描述性分析

根据 `q1_0.csv`，我们可以对中国自三国进口大豆的规模和结构进行初步描述：

1. **贸易战前（2015–2017 年）**
   - 中国对三国大豆关税大致处于统一的低水平（约 3%），三国之间价格差异主要来源于基础离岸价格和运输成本；
   - 以 2017 年为例（单位：亿美元）：
     - 美国：`import_value_usd ≈ 126` 亿；
     - 巴西：`≈ 195` 亿；
     - 阿根廷：`≈ 9` 亿；
     - 三国合计约 330 亿，其中美国份额约 38%，巴西约 59%，阿根廷约 3%。

2. **贸易战爆发后（2018 年起）**
   - 中国对美大豆加征高额关税，`tariff_cn_on_exporter` 从 3% 抬升至 28%–33% 区间，而对巴西和阿根廷保持约 3%；
   - 以 2018 年为例：
     - 美国对华出口额约 62 亿美元，市场份额约 20%；
     - 巴西对华出口额约 246 亿美元，市场份额约 77%；
     - 相比 2017 年，美国份额从约 38% 跌至 20%左右，巴西份额从 59% 上升到近 77%。

3. **关税部分回调后（2020–2024 年）**
   - 2020 年以后，中国对美大豆关税有所调整，但整体仍高于对巴西、阿根廷的税率；
   - 到 2024 年，对美大豆关税约为 13%，而对巴西、阿根廷仍为约 3%；
   - 2024 年三国对华出口额约为：美国 126 亿、巴西 390 亿、阿根廷 12 亿，美国份额仍显著低于贸易战前水平，而巴西则稳居主导地位。

整体上，`q1_0.csv` 已经清晰体现了：**在中国对美大豆加征高关税之后，中国大豆进口结构明显由“美巴双极”向“以巴西为主”的格局转移**。

### 3.2 价格与关税相关变量

在 `load_external_china_imports()` 中，我们对原始数据进一步构造价格与关税变量：

- `unit_value`：若原表中具有 `unit_price_usd_per_ton`，则直接赋值；否则按 `import_value_usd / import_quantity_tonnes` 计算；
- `price_with_tariff = unit_value * (1 + tariff_cn_on_exporter)`：表示含中国关税后的单位到岸价；

进一步，在 `prepare_panel_for_estimation()` 中，我们对关键变量取对数以便于线性回归：

- `ln_import_value = log(import_value_usd + 1)`；
- `ln_import_quantity = log(import_quantity_tonnes + 1)`；
- `ln_price_with_tariff = log(price_with_tariff + 1e-6)`；
- `ln_unit_value = log(unit_value + 1e-6)`。

这些对数变量用于刻画“进口金额/数量对价格与关税的弹性反应”。

### 3.3 市场份额与相对关税变量

为刻画三国之间的替代关系，我们在年度层面计算市场份额与相对指标：

1. **市场份额**

   对每个年份 t，先计算三国对华进口金额之和 Σ_j `import_value_usd`，然后构造：

   - `market_share = import_value_usd / total_by_year`：出口国在当年三国对华出口中的金额占比。

2. **相对于美国的份额比与关税差**

   - 首先将美国的份额与关税按年份映射为基准：
     - `us_share_ref`：年份 t 下美国的市场份额；
     - `us_tariff_ref`：年份 t 下中国对美国大豆的关税税率；
   - 对于每个出口国 i（含美国本身）构造：
     - `ln_share_ratio = log((market_share + 1e-6) / (us_share_ref + 1e-6))`：出口国相对于美国的份额比的对数；
     - `tariff_diff_vs_us = tariff_cn_on_exporter - us_tariff_ref`：出口国 i 相对于美国在中国市场的关税差异。

这些变量为后续的来源替代模型提供核心解释变量。

---

## 4. 模型设计与代码结构

### 4.1 `SoybeanTradeModel` 类结构

第一问的建模与仿真逻辑主要封装在 `src/models/q1_soybeans.py` 中的 `SoybeanTradeModel` 类中，该类的核心成员包括：

- `loader = TariffDataLoader()`：用于加载题目提供的美国贸易与关税数据；
- `mapper = HSMapper()`：用于根据 HS 编码定位大豆相关商品（在本题中主要用于扩展模型时，`q1_0.csv` 本身已是聚合后的中国进口数据）；
- `panel_data`：保存当前用于回归和仿真的面板数据 DataFrame；
- `elasticities`：存储估计得到的关键弹性参数；
- `model_results`：存储完整的回归结果对象，便于输出统计量。

类中与第一问直接相关的主要方法有：

- `load_external_china_imports()`：加载 `q1_0.csv` 或外部中国进口数据，并构造基础价格与税率变量；
- `prepare_panel_for_estimation()`：在上述基础上构造对数变量、市场份额和相对关税，形成可用于回归的年度面板；
- `estimate_trade_elasticities()`：估计进口需求的价格弹性和来源替代的关税弹性；
- `simulate_tariff_scenarios()`：给定基期数据和弹性参数，模拟不同关税情景下三国对华大豆出口规模和市场份额的变化；
- `plot_q1_results()`：对情景仿真结果进行可视化。

此外，`run_q1_analysis()` 函数调用上述步骤，形成“读取数据 → 估计 → 仿真 → 出图”的一键分析管线。

### 4.2 中国大豆进口需求模型

我们首先关注中国自三国大豆进口规模对价格（含关税）的敏感度，采用对数线性需求模型：

\[
\ln M_{it} = \alpha + \beta\, \ln P^{T}_{it} + C(exporter) + \varepsilon_{it},
\]

其中：

- \(M_{it}\)：中国自出口国 i 在年份 t 的大豆进口金额（`import_value_usd`）；
- \(P^{T}_{it}\)：含中国关税的单位到岸价（`price_with_tariff`）；
- `C(exporter)`：出口国固定效应，用于控制各国之间的长期结构性差异；
- 系数 \(\beta\) 表示**价格弹性**，反映含税价格变动 1% 对进口金额的百分比影响。

在代码中，该模型通过 `statsmodels.formula.api` 实现：

- 回归式：`ln_import_value ~ ln_price_with_tariff + C(exporter)`；
- 估计结果存储在 `self.model_results['trade_elasticity']` 中，对应的价格弹性存入 `self.elasticities['price_elasticity']`。

### 4.3 来源替代模型（市场份额视角）

为了刻画“谁从美国丢失的市场中获益”，我们进一步引入以美国为基准的来源替代模型：

\[
\ln \frac{S_{it}}{S_{US,t}} = \theta\, (\tau_{it} - \tau_{US,t}) + C(exporter) + u_{it}, \quad i \neq \text{US},
\]

其中：

- \(S_{it}\)：出口国 i 在年份 t 的市场份额（`market_share`）；
- \(S_{US,t}\)：同年美国的市场份额；
- \(\tau_{it}\) 与 \(\tau_{US,t}\)：中国对 i 国与美国大豆的从价关税税率；
- \(\tau_{it} - \tau_{US,t}\) 即 `tariff_diff_vs_us`；
- 系数 \(\theta\) 表示**相对关税对相对市场份额的替代弹性**。

在代码中：

- 对非美国样本（巴西、阿根廷）构建 `ln_share_ratio` 与 `tariff_diff_vs_us`；
- 使用 OLS 估计：`ln_share_ratio ~ tariff_diff_vs_us + C(exporter)`；
- 回归结果存储在 `self.model_results['share_elasticity']` 中，对应的弹性系数存入 `self.elasticities['share_elasticity']`。

这一模型体现了 Armington 假设下的来源替代机制：在总需求给定时，相对关税较低的国家可以在中国市场中获得更高的份额。

### 4.4 关税情景模拟与结果可视化

在估计得到价格弹性与替代弹性后，我们围绕 2024 年这一最新观测年份构造不同关税情景，模拟中国对美大豆关税进一步调整对三国大豆出口的影响。`simulate_tariff_scenarios()` 中预设了三个典型情景：

1. **`baseline`（基准情景）**
   - 维持 2024 年的观察关税水平：
     - 美国：约 13%；
     - 巴西、阿根廷：约 3%。

2. **`reciprocal_tariff`（进一步报复性关税）**
   - 在现有关税基础上，对美国大豆额外加征约 25 个百分点关税：
     - 美国：`旧税率 + 0.25`；
     - 巴西、阿根廷：不变。

3. **`full_retaliation`（更高强度反制）**
   - 在现有关税基础上，对美国大豆额外加征约 50 个百分点关税：
     - 美国：`旧税率 + 0.50`；
     - 巴西、阿根廷：不变。

对每个情景与每个出口国，函数会：

- 根据新关税计算新的含税价格 `new_price_with_tariff`；
- 利用价格弹性估计进口金额的百分比变化；
- 得到新的 `simulated_import_value`，并在情景内归一化为新的 `market_share`；
- 将结果写入 `results/q1_scenario_exports.csv`，供绘图与论文撰写使用。

`plot_q1_results()` 在此基础上输出两类图表：

- 不同情景下三国在中国大豆市场的份额对比图（`q1_shares_before_after.pdf`）；
- 不同情景下三国对华大豆出口金额的柱状对比图（`q1_import_values_scenarios.pdf`）。

这些图可以直接作为论文中的结果展示。

---

## 5. 主要结果与经济含义（定性总结）

结合 `q1_0.csv` 的历史事实与上述模型结构，我们可以做出如下定性总结：

### 5.1 历史数据揭示的结构变化

- 在中国对美大豆加征高关税以前（2015–2017 年），美国和巴西共同构成中国大豆进口的主要来源，美国份额约 35%–40%，巴西约 55%–60%，阿根廷保持在较小比例；
- 自 2018 年中国对美大豆关税大幅提高后，美国对华出口额明显下滑，市场份额在短期内由近 40% 跌至约 20%；
- 同期，巴西迅速填补美国留下的缺口，对华出口额大幅增加，市场份额上升至约 75% 以上并在随后几年保持主导地位；
- 即使在部分关税回调后的 2024 年，美国份额仍显著低于贸易战前水平，说明高关税与预期不确定性已对中美大豆贸易形成持续抑制。

### 5.2 模型估计与弹性含义（方向性）

通过对 2015–2024 年面板数据进行回归估计：

- 在进口需求模型中，含税价格的系数（价格弹性）预期为负，表明在其他条件不变时，中国自某国的大豆进口金额会随着其含税价格上升而下降；
- 在来源替代模型中，相对关税差的系数预期为负，意味着当某一出口国相对于美国享有更低的关税时，其相对市场份额会提升，从而在中国市场中部分替代美国的地位；
- 历史数据所呈现的“美国份额下降、巴西份额上升”的走势，与这一预期方向是一致的，侧面支持了我们模型的设定合理性。

### 5.3 关税情景下三国大豆产业的影响（定性）

在设定的不同关税情景下，结合估计得到的价格弹性和替代弹性，模型给出的模拟结果具有以下特征：

1. **美国大豆产业**
   - 随着中国对美大豆关税的进一步提高，美国对华大豆出口金额和市场份额将持续下降，在高关税情景下甚至可能被巴西大幅挤出；
   - 对美国大豆种植者和相关产业链而言，中国市场的萎缩意味着收入不确定性上升，可能迫使其寻求其他出口市场或调整种植结构。

2. **巴西与阿根廷大豆产业**
   - 作为主要替代国，巴西在高关税情景下显著受益，其对华出口规模和市场份额进一步扩张，加强其在全球大豆贸易中的主导地位；
   - 阿根廷虽然基础份额相对较小，但在极端情景下同样会获得一定增量需求，其大豆出口收益有所提升。

3. **全球大豆贸易格局**
   - 在关税长期处于高位的极端情景下，全球大豆贸易格局可能由“美巴双头”演化为“以巴西为核心、阿根廷为补充”的新均衡；
   - 这不仅改变三国产业收益的地理分布，也会对全球农产品价格和供给安全产生溢出影响。

---

## 6. 复现实验与结果文件说明

为了保障结果可复现，我们将第一问的分析流程封装为脚本：

- 入口函数：`run_q1_analysis()`（位于 `src/models/q1_soybeans.py`）；
- 执行步骤：
  1. 调用 `prepare_panel_for_estimation()` 读取并整理 `q1_0.csv` 数据；
  2. 调用 `estimate_trade_elasticities()` 估计价格弹性与替代弹性，并将结果写入 `results/q1_elasticities.json`；
  3. 调用 `simulate_tariff_scenarios()` 在 2024 年基期上进行关税情景仿真，输出 `results/q1_scenario_exports.csv`；
  4. 调用 `plot_q1_results()` 生成情景对比图，输出到 `figures/q1_shares_before_after.pdf` 和 `figures/q1_import_values_scenarios.pdf`。

通过上述结果文件与图表，可以完整复现我们在论文中关于第一问的：

- 数据来源与处理过程；
- 进口需求与来源替代模型的设定与估计思路；
- 在不同关税情景下三国对华大豆出口规模与结构的预测结论。

该文档旨在作为第一问的“数据与方法说明”，为论文正文中的数学模型推导与政策讨论提供清晰的技术支撑。
